<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/WEB-INF/templates/template.xhtml">
    
    <ui:define name="title">
        #{msg['admin.news.title']} - #{applicationBean.applicationName}
    </ui:define>
    
    <ui:define name="css">
        <style type="text/css">
            .admin-header {
                background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
                color: white;
                padding: 2rem 0;
                margin-bottom: 2rem;
                border-radius: 10px;
            }
            
            .admin-title {
                font-size: 2rem;
                font-weight: bold;
                margin-bottom: 0.5rem;
            }
            
            .admin-subtitle {
                opacity: 0.9;
                font-size: 1.1rem;
            }
            
            .stats-cards {
                margin-bottom: 2rem;
            }
            
            .stat-card {
                background: white;
                border-radius: 10px;
                padding: 1.5rem;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                text-align: center;
                transition: transform 0.3s ease;
            }
            
            .stat-card:hover {
                transform: translateY(-2px);
            }
            
            .stat-icon {
                font-size: 2.5rem;
                margin-bottom: 1rem;
            }
            
            .stat-number {
                font-size: 2rem;
                font-weight: bold;
                color: #1f2937;
                margin-bottom: 0.5rem;
            }
            
            .stat-label {
                color: #6b7280;
                font-size: 0.9rem;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .stat-total { color: #3b82f6; }
            .stat-published { color: #10b981; }
            .stat-draft { color: #f59e0b; }
            .stat-recent { color: #8b5cf6; }
            
            .filters-panel {
                background: white;
                border-radius: 10px;
                padding: 1.5rem;
                margin-bottom: 2rem;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            
            .data-table-container {
                background: white;
                border-radius: 10px;
                padding: 1.5rem;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            
            .news-thumbnail {
                width: 60px;
                height: 45px;
                object-fit: cover;
                border-radius: 6px;
                margin-right: 1rem;
            }
            
            .news-info {
                display: flex;
                align-items: center;
            }
            
            .news-details {
                flex: 1;
            }
            
            .news-title {
                font-weight: 600;
                color: #1f2937;
                margin-bottom: 0.25rem;
                line-height: 1.3;
            }
            
            .news-summary {
                color: #6b7280;
                font-size: 0.9rem;
                line-height: 1.4;
            }
            
            .status-badge {
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 500;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .status-published {
                background: #d1fae5;
                color: #065f46;
            }
            
            .status-draft {
                background: #fef3c7;
                color: #92400e;
            }
            
            .category-tags {
                display: flex;
                flex-wrap: wrap;
                gap: 0.25rem;
            }
            
            .category-tag {
                background: #e0f2fe;
                color: #0277bd;
                padding: 0.2rem 0.5rem;
                border-radius: 12px;
                font-size: 0.75rem;
                font-weight: 500;
            }
            
            .author-info {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            
            .author-avatar {
                width: 30px;
                height: 30px;
                border-radius: 50%;
                background: #e5e7eb;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                color: #374151;
                font-size: 0.8rem;
            }
            
            .action-buttons {
                display: flex;
                gap: 0.5rem;
            }
            
            .btn-sm {
                padding: 0.375rem 0.75rem;
                font-size: 0.875rem;
            }
            
            .toolbar {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1.5rem;
                flex-wrap: wrap;
                gap: 1rem;
            }
            
            .bulk-actions {
                display: flex;
                gap: 0.5rem;
                align-items: center;
            }
            
            .search-box {
                min-width: 300px;
            }
            
            .dialog-content {
                padding: 1rem;
            }
            
            .form-group {
                margin-bottom: 1.5rem;
            }
            
            .form-label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 600;
                color: #374151;
            }
            
            .required {
                color: #dc2626;
            }
            
            .editor-container {
                border: 1px solid #d1d5db;
                border-radius: 6px;
                min-height: 300px;
            }
            
            .image-preview {
                max-width: 200px;
                max-height: 150px;
                border-radius: 6px;
                margin-top: 0.5rem;
            }
            
            .stats-summary {
                display: flex;
                gap: 1rem;
                margin-top: 1rem;
                font-size: 0.9rem;
                color: #6b7280;
            }
            
            .stat-item {
                display: flex;
                align-items: center;
                gap: 0.3rem;
            }
            
            @media (max-width: 768px) {
                .admin-title {
                    font-size: 1.5rem;
                }
                
                .toolbar {
                    flex-direction: column;
                    align-items: stretch;
                }
                
                .search-box {
                    min-width: auto;
                }
                
                .bulk-actions {
                    justify-content: center;
                }
                
                .action-buttons {
                    flex-direction: column;
                }
                
                .news-info {
                    flex-direction: column;
                    align-items: flex-start;
                }
                
                .news-thumbnail {
                    width: 100%;
                    height: 120px;
                    margin-right: 0;
                    margin-bottom: 0.5rem;
                }
            }
        </style>
    </ui:define>
    
    <ui:define name="content">
        <!-- Cabeçalho Admin -->
        <div class="admin-header">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h1 class="admin-title">
                            <i class="pi pi-file-edit"></i>
                            #{msg['admin.news.title']}
                        </h1>
                        <p class="admin-subtitle">#{msg['admin.news.subtitle']}</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="container">
            <!-- Cards de Estatísticas -->
            <div class="stats-cards">
                <div class="row">
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon stat-total">
                                <i class="pi pi-file"></i>
                            </div>
                            <div class="stat-number">#{noticiaAdminBean.totalNoticias}</div>
                            <div class="stat-label">#{msg['admin.stats.total.news']}</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon stat-published">
                                <i class="pi pi-check-circle"></i>
                            </div>
                            <div class="stat-number">#{noticiaAdminBean.noticiasPublicadas}</div>
                            <div class="stat-label">#{msg['admin.stats.published.news']}</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon stat-draft">
                                <i class="pi pi-file-edit"></i>
                            </div>
                            <div class="stat-number">#{noticiaAdminBean.rascunhos}</div>
                            <div class="stat-label">#{msg['admin.stats.drafts']}</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-icon stat-recent">
                                <i class="pi pi-calendar-plus"></i>
                            </div>
                            <div class="stat-number">#{noticiaAdminBean.noticiasRecentes}</div>
                            <div class="stat-label">#{msg['admin.stats.recent.news']}</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Painel de Filtros -->
            <div class="filters-panel">
                <h:form id="filtersForm">
                    <div class="row align-items-end">
                        <div class="col-lg-2 col-md-6 mb-3">
                            <label class="form-label">#{msg['filter.status']}</label>
                            <p:selectOneMenu value="#{noticiaAdminBean.filtroStatus}" 
                                           styleClass="form-control">
                                <f:selectItem itemLabel="#{msg['filter.all']}" itemValue=""/>
                                <f:selectItem itemLabel="#{msg['status.published']}" itemValue="true"/>
                                <f:selectItem itemLabel="#{msg['status.draft']}" itemValue="false"/>
                            </p:selectOneMenu>
                        </div>
                        
                        <div class="col-lg-2 col-md-6 mb-3">
                            <label class="form-label">#{msg['filter.category']}</label>
                            <p:selectOneMenu value="#{noticiaAdminBean.filtroCategoria}" 
                                           styleClass="form-control">
                                <f:selectItem itemLabel="#{msg['filter.all']}" itemValue=""/>
                                <f:selectItems value="#{noticiaAdminBean.categorias}" 
                                             var="categoria" 
                                             itemLabel="#{categoria.nome}" 
                                             itemValue="#{categoria.id}"/>
                            </p:selectOneMenu>
                        </div>
                        
                        <div class="col-lg-2 col-md-6 mb-3">
                            <label class="form-label">#{msg['filter.author']}</label>
                            <p:selectOneMenu value="#{noticiaAdminBean.filtroAutor}" 
                                           styleClass="form-control">
                                <f:selectItem itemLabel="#{msg['filter.all']}" itemValue=""/>
                                <f:selectItems value="#{noticiaAdminBean.autores}" 
                                             var="autor" 
                                             itemLabel="#{autor.nome}" 
                                             itemValue="#{autor.id}"/>
                            </p:selectOneMenu>
                        </div>
                        
                        <div class="col-lg-2 col-md-6 mb-3">
                            <label class="form-label">#{msg['filter.date.from']}</label>
                            <p:calendar value="#{noticiaAdminBean.dataInicio}" 
                                      pattern="#{msg['date.format.input']}"
                                      showOn="button"
                                      styleClass="form-control"/>
                        </div>
                        
                        <div class="col-lg-2 col-md-6 mb-3">
                            <label class="form-label">#{msg['filter.date.to']}</label>
                            <p:calendar value="#{noticiaAdminBean.dataFim}" 
                                      pattern="#{msg['date.format.input']}"
                                      showOn="button"
                                      styleClass="form-control"/>
                        </div>
                        
                        <div class="col-lg-2 col-md-6 mb-3">
                            <p:commandButton value="#{msg['button.filter']}" 
                                           action="#{noticiaAdminBean.aplicarFiltros}"
                                           update="newsTable"
                                           styleClass="btn btn-primary me-2"
                                           icon="pi pi-search"/>
                            <p:commandButton value="#{msg['button.clear']}" 
                                           action="#{noticiaAdminBean.limparFiltros}"
                                           update="filtersForm newsTable"
                                           styleClass="btn btn-outline-secondary"
                                           icon="pi pi-times"/>
                        </div>
                    </div>
                </h:form>
            </div>
            
            <!-- Tabela de Notícias -->
            <div class="data-table-container">
                <div class="toolbar">
                    <div class="bulk-actions">
                        <p:commandButton value="#{msg['button.new.news']}" 
                                       onclick="PF('newsDialog').show()" 
                                       styleClass="btn btn-success"
                                       icon="pi pi-plus"/>
                        
                        <p:commandButton value="#{msg['button.publish.selected']}" 
                                       action="#{noticiaAdminBean.publicarSelecionadas}"
                                       update="newsTable"
                                       styleClass="btn btn-outline-success btn-sm"
                                       icon="pi pi-check"
                                       disabled="#{empty noticiaAdminBean.noticiasSelecionadas}"/>
                        
                        <p:commandButton value="#{msg['button.unpublish.selected']}" 
                                       action="#{noticiaAdminBean.despublicarSelecionadas}"
                                       update="newsTable"
                                       styleClass="btn btn-outline-warning btn-sm"
                                       icon="pi pi-times"
                                       disabled="#{empty noticiaAdminBean.noticiasSelecionadas}"/>
                        
                        <p:commandButton value="#{msg['button.delete.selected']}" 
                                       action="#{noticiaAdminBean.excluirSelecionadas}"
                                       update="newsTable"
                                       styleClass="btn btn-outline-danger btn-sm"
                                       icon="pi pi-trash"
                                       disabled="#{empty noticiaAdminBean.noticiasSelecionadas}">
                            <p:confirm header="#{msg['confirm.title']}" 
                                     message="#{msg['confirm.delete.selected.news']}"
                                     icon="pi pi-exclamation-triangle"/>
                        </p:commandButton>
                    </div>
                    
                    <div class="search-box">
                        <h:form>
                            <p:inputText value="#{noticiaAdminBean.termoPesquisa}" 
                                       placeholder="#{msg['search.news.placeholder']}"
                                       styleClass="form-control">
                                <p:ajax event="keyup" 
                                      listener="#{noticiaAdminBean.pesquisar}" 
                                      update="newsTable" 
                                      delay="500"/>
                            </p:inputText>
                        </h:form>
                    </div>
                </div>
                
                <h:form id="newsTableForm">
                    <p:dataTable id="newsTable" 
                               value="#{noticiaAdminBean.noticias}" 
                               var="noticia"
                               lazy="true"
                               paginator="true"
                               rows="15"
                               paginatorPosition="both"
                               paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                               rowsPerPageTemplate="10,15,25"
                               selection="#{noticiaAdminBean.noticiasSelecionadas}"
                               rowKey="#{noticia.id}"
                               styleClass="table table-striped"
                               emptyMessage="#{msg['table.no.records']}"
                               currentPageReportTemplate="#{msg['table.pagination.template']}">
                        
                        <p:column selectionMode="multiple" style="width:3rem"/>
                        
                        <p:column headerText="#{msg['table.news.info']}" sortBy="#{noticia.titulo}" style="width:40%">
                            <div class="news-info">
                                <h:graphicImage name="images/news-placeholder.jpg" 
                                              alt="#{noticia.titulo}"
                                              styleClass="news-thumbnail"
                                              rendered="#{empty noticia.imagemUrl}"/>
                                <h:graphicImage value="#{noticia.imagemUrl}" 
                                              alt="#{noticia.titulo}"
                                              styleClass="news-thumbnail"
                                              rendered="#{not empty noticia.imagemUrl}"/>
                                
                                <div class="news-details">
                                    <div class="news-title">#{noticia.titulo}</div>
                                    <div class="news-summary">#{fn:substring(noticia.resumo, 0, 100)}#{fn:length(noticia.resumo) > 100 ? '...' : ''}</div>
                                    
                                    <div class="category-tags mt-2">
                                        <ui:repeat value="#{noticia.categorias}" var="categoria">
                                            <span class="category-tag">#{categoria.nome}</span>
                                        </ui:repeat>
                                    </div>
                                    
                                    <div class="stats-summary">
                                        <span class="stat-item">
                                            <i class="pi pi-eye"></i>
                                            #{noticia.visualizacoes}
                                        </span>
                                        <span class="stat-item">
                                            <i class="pi pi-comments"></i>
                                            #{noticia.totalComentarios}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </p:column>
                        
                        <p:column headerText="#{msg['table.author']}" sortBy="#{noticia.autor.nome}" style="width:12%">
                            <div class="author-info">
                                <div class="author-avatar">
                                    #{fn:substring(noticia.autor.nome, 0, 1)}
                                </div>
                                <span>#{noticia.autor.nome}</span>
                            </div>
                        </p:column>
                        
                        <p:column headerText="#{msg['table.status']}" sortBy="#{noticia.publicada}" style="width:8%">
                            <span class="status-badge #{noticia.publicada ? 'status-published' : 'status-draft'}">
                                <i class="pi #{noticia.publicada ? 'pi-check' : 'pi-file-edit'}"></i>
                                #{noticia.publicada ? msg['status.published'] : msg['status.draft']}
                            </span>
                        </p:column>
                        
                        <p:column headerText="#{msg['table.publication.date']}" sortBy="#{noticia.dataPublicacao}" style="width:10%">
                            <h:outputText value="#{noticia.dataPublicacao}" rendered="#{noticia.publicada}">
                                <f:convertDateTime pattern="#{msg['date.format.short']}"/>
                            </h:outputText>
                            <span class="text-muted" rendered="#{not noticia.publicada}">#{msg['status.not.published']}</span>
                        </p:column>
                        
                        <p:column headerText="#{msg['table.last.update']}" sortBy="#{noticia.dataAtualizacao}" style="width:10%">
                            <h:outputText value="#{noticia.dataAtualizacao}">
                                <f:convertDateTime pattern="#{msg['date.format.short']}"/>
                            </h:outputText>
                        </p:column>
                        
                        <p:column headerText="#{msg['table.actions']}" style="width:15%">
                            <div class="action-buttons">
                                <p:commandButton icon="pi pi-eye" 
                                               title="#{msg['button.view']}"
                                               action="#{noticiaAdminBean.visualizarNoticia(noticia)}"
                                               styleClass="btn btn-outline-info btn-sm"/>
                                
                                <p:commandButton icon="pi pi-pencil" 
                                               title="#{msg['button.edit']}"
                                               action="#{noticiaAdminBean.editarNoticia(noticia)}"
                                               oncomplete="PF('newsDialog').show()"
                                               update="newsDialogContent"
                                               styleClass="btn btn-outline-primary btn-sm"/>
                                
                                <p:commandButton icon="#{noticia.publicada ? 'pi pi-times' : 'pi pi-check'}" 
                                               title="#{noticia.publicada ? msg['button.unpublish'] : msg['button.publish']}"
                                               action="#{noticiaAdminBean.alternarPublicacao(noticia)}"
                                               update="newsTable"
                                               styleClass="btn #{noticia.publicada ? 'btn-outline-warning' : 'btn-outline-success'} btn-sm">
                                    <p:confirm header="#{msg['confirm.title']}" 
                                             message="#{noticia.publicada ? msg['confirm.unpublish.news'] : msg['confirm.publish.news']}"
                                             icon="pi pi-exclamation-triangle"/>
                                </p:commandButton>
                                
                                <p:commandButton icon="pi pi-trash" 
                                               title="#{msg['button.delete']}"
                                               action="#{noticiaAdminBean.excluirNoticia(noticia)}"
                                               update="newsTable"
                                               styleClass="btn btn-outline-danger btn-sm">
                                    <p:confirm header="#{msg['confirm.title']}" 
                                             message="#{msg['confirm.delete.news']}"
                                             icon="pi pi-exclamation-triangle"/>
                                </p:commandButton>
                            </div>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </div>
        </div>
        
        <!-- Dialog de Notícia -->
        <p:dialog id="newsDialog" 
                widgetVar="newsDialog" 
                header="#{noticiaAdminBean.editando ? msg['dialog.edit.news'] : msg['dialog.new.news']}"
                modal="true" 
                width="900" 
                height="700"
                resizable="true"
                maximizable="true"
                closeOnEscape="true">
            
            <div id="newsDialogContent">
                <h:form id="newsForm" enctype="multipart/form-data">
                    <div class="dialog-content">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="form-group">
                                    <label class="form-label">
                                        #{msg['form.title']} <span class="required">*</span>
                                    </label>
                                    <p:inputText value="#{noticiaAdminBean.noticiaEdicao.titulo}" 
                                               styleClass="form-control"
                                               required="true"
                                               requiredMessage="#{msg['validation.title.required']}"
                                               maxlength="200"/>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        #{msg['form.summary']} <span class="required">*</span>
                                    </label>
                                    <p:inputTextarea value="#{noticiaAdminBean.noticiaEdicao.resumo}" 
                                                   rows="3"
                                                   styleClass="form-control"
                                                   required="true"
                                                   requiredMessage="#{msg['validation.summary.required']}"
                                                   maxlength="500"/>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        #{msg['form.content']} <span class="required">*</span>
                                    </label>
                                    <p:textEditor value="#{noticiaAdminBean.noticiaEdicao.conteudo}" 
                                                width="100%" 
                                                height="300"
                                                styleClass="editor-container"
                                                required="true"
                                                requiredMessage="#{msg['validation.content.required']}"/>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="form-label">#{msg['form.categories']}</label>
                                    <p:selectCheckboxMenu value="#{noticiaAdminBean.categoriasSelecionadas}" 
                                                        label="#{msg['form.select.categories']}"
                                                        styleClass="form-control">
                                        <f:selectItems value="#{noticiaAdminBean.categorias}" 
                                                     var="categoria" 
                                                     itemLabel="#{categoria.nome}" 
                                                     itemValue="#{categoria.id}"/>
                                    </p:selectCheckboxMenu>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">#{msg['form.author']}</label>
                                    <p:selectOneMenu value="#{noticiaAdminBean.noticiaEdicao.autor.id}" 
                                                   styleClass="form-control">
                                        <f:selectItems value="#{noticiaAdminBean.autores}" 
                                                     var="autor" 
                                                     itemLabel="#{autor.nome}" 
                                                     itemValue="#{autor.id}"/>
                                    </p:selectOneMenu>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">#{msg['form.image']}</label>
                                    <p:fileUpload value="#{noticiaAdminBean.imagemUpload}" 
                                                mode="simple" 
                                                skinSimple="true"
                                                accept="image/*"
                                                allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                                sizeLimit="5242880"
                                                invalidSizeMessage="#{msg['validation.image.size']}"
                                                invalidFileMessage="#{msg['validation.image.type']}"/>
                                    
                                    <h:graphicImage value="#{noticiaAdminBean.noticiaEdicao.imagemUrl}" 
                                                  alt="#{msg['form.current.image']}"
                                                  styleClass="image-preview"
                                                  rendered="#{not empty noticiaAdminBean.noticiaEdicao.imagemUrl}"/>
                                </div>
                                
                                <div class="form-group">
                                    <p:selectBooleanCheckbox value="#{noticiaAdminBean.noticiaEdicao.publicada}" 
                                                           itemLabel="#{msg['form.publish.immediately']}"/>
                                </div>
                                
                                <div class="form-group" rendered="#{noticiaAdminBean.noticiaEdicao.publicada}">
                                    <label class="form-label">#{msg['form.publication.date']}</label>
                                    <p:calendar value="#{noticiaAdminBean.noticiaEdicao.dataPublicacao}" 
                                              pattern="#{msg['date.format.input']}"
                                              showOn="button"
                                              showTime="true"
                                              styleClass="form-control"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dialog-footer d-flex justify-content-between align-items-center mt-3">
                        <div>
                            <p:commandButton value="#{msg['button.preview']}" 
                                           action="#{noticiaAdminBean.visualizarPreview}"
                                           styleClass="btn btn-outline-info"
                                           icon="pi pi-eye"
                                           target="_blank"/>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <p:commandButton value="#{msg['button.cancel']}" 
                                           onclick="PF('newsDialog').hide()" 
                                           styleClass="btn btn-outline-secondary"
                                           type="button"/>
                            
                            <p:commandButton value="#{msg['button.save.draft']}" 
                                           action="#{noticiaAdminBean.salvarRascunho}"
                                           update="newsTable newsDialogContent"
                                           styleClass="btn btn-outline-primary"
                                           icon="pi pi-save"/>
                            
                            <p:commandButton value="#{msg['button.save.publish']}" 
                                           action="#{noticiaAdminBean.salvarEPublicar}"
                                           update="newsTable newsDialogContent"
                                           oncomplete="if (args && !args.validationFailed) PF('newsDialog').hide()"
                                           styleClass="btn btn-success"
                                           icon="pi pi-check"/>
                        </div>
                    </div>
                </h:form>
            </div>
        </p:dialog>
        
        <!-- Confirmação -->
        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
            <p:commandButton value="#{msg['button.yes']}" type="button" styleClass="btn btn-primary ui-confirmdialog-yes" icon="pi pi-check"/>
            <p:commandButton value="#{msg['button.no']}" type="button" styleClass="btn btn-outline-secondary ui-confirmdialog-no" icon="pi pi-times"/>
        </p:confirmDialog>
    </ui:define>
    
    <ui:define name="javascript">
        <script type="text/javascript">
            // Atualizar estatísticas periodicamente
            function updateNewsStats() {
                if (typeof PrimeFaces !== 'undefined') {
                    // Implementar atualização automática das estatísticas
                }
            }
            
            // Atualizar a cada 30 segundos
            setInterval(updateNewsStats, 30000);
            
            // Auto-save para rascunhos
            let autoSaveTimer;
            function startAutoSave() {
                clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    // Implementar auto-save
                    console.log('Auto-salvando rascunho...');
                }, 30000); // 30 segundos
            }
            
            // Contador de caracteres
            document.addEventListener('DOMContentLoaded', function() {
                const titleInput = document.querySelector('input[id*="titulo"]');
                const summaryTextarea = document.querySelector('textarea[id*="resumo"]');
                
                function addCharCounter(element, maxChars) {
                    if (element) {
                        const counter = document.createElement('small');
                        counter.className = 'form-text text-muted float-end';
                        element.parentNode.appendChild(counter);
                        
                        function updateCounter() {
                            const remaining = maxChars - element.value.length;
                            counter.textContent = `${remaining} caracteres restantes`;
                            counter.style.color = remaining < 20 ? '#dc3545' : '#6c757d';
                        }
                        
                        element.addEventListener('input', updateCounter);
                        updateCounter();
                    }
                }
                
                addCharCounter(titleInput, 200);
                addCharCounter(summaryTextarea, 500);
            });
            
            // Atalhos de teclado
            document.addEventListener('keydown', function(e) {
                // Ctrl+N para nova notícia
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    PF('newsDialog').show();
                }
                
                // Ctrl+S para salvar (quando dialog estiver aberto)
                if (e.ctrlKey && e.key === 's' && PF('newsDialog').isVisible()) {
                    e.preventDefault();
                    // Trigger save button
                }
                
                // Escape para fechar dialogs
                if (e.key === 'Escape') {
                    if (PF('newsDialog').isVisible()) {
                        PF('newsDialog').hide();
                    }
                }
            });
            
            // Validação de imagem
            function validateImageUpload(input) {
                const file = input.files[0];
                if (file) {
                    const maxSize = 5 * 1024 * 1024; // 5MB
                    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];
                    
                    if (file.size > maxSize) {
                        alert('Arquivo muito grande. Máximo 5MB.');
                        input.value = '';
                        return false;
                    }
                    
                    if (!allowedTypes.includes(file.type)) {
                        alert('Tipo de arquivo não permitido. Use apenas JPG, PNG ou GIF.');
                        input.value = '';
                        return false;
                    }
                }
                return true;
            }
        </script>
    </ui:define>
    
</ui:composition>
</html>